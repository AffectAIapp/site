<!doctype html>
<html lang="pt-br">
<head>
  <!-- Google Tag Manager -->
  <script>
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;
      j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-K9TFCGX9');
  </script>
  <!-- End GTM -->

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>AffectAI Chat</title>

  <style>
    :root{
      --bg:#f6f5fa;
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
    }

    *{ box-sizing: border-box; }

    html, body{
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--bg);
      overflow: hidden;
      -webkit-text-size-adjust: 100%;
    }

    /* App fullscreen */
    .app{
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh; /* vai ser ajustado via JS */
      padding-top: var(--safe-top);
      padding-bottom: var(--safe-bottom);
      padding-left: var(--safe-left);
      padding-right: var(--safe-right);
    }

    /* Iframe ocupa tudo sempre */
    #tsFrame{
      width: 100%;
      height: 100%;
      border: 0;
      display: block;
      background: transparent;
    }

    /* Se o Thinkstack tentar injetar bolha por cima, a gente mata */
    .thinkstack-launcher,
    [class*="launcher"],
    [id*="launcher"],
    [class*="bubble"],
    [class*="fab"]{
      display: none !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
  </style>
</head>

<body>
  <!-- GTM (noscript) -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K9TFCGX9" height="0" width="0"
      style="display:none;visibility:hidden"></iframe>
  </noscript>

  <div class="app" id="app">
    <iframe
      id="tsFrame"
      src="https://app.thinkstack.ai/bot/index.html?chatbot_id=6960ea094e96c848acd0e419&type=inline"
      allow="clipboard-read; clipboard-write"
      referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>

  <script>
    (function () {
      var app = document.getElementById('app');

      function setAppHeight() {
        // visualViewport é o jeito mais confiável no iOS (teclado + barras do Safari)
        var h = (window.visualViewport && window.visualViewport.height)
          ? window.visualViewport.height
          : window.innerHeight;

        app.style.height = h + 'px';
      }

      setAppHeight();

      window.addEventListener('resize', setAppHeight, { passive: true });
      window.addEventListener('orientationchange', function () {
        setTimeout(setAppHeight, 150);
      }, { passive: true });

      if (window.visualViewport) {
        window.visualViewport.addEventListener('resize', setAppHeight, { passive: true });
        window.visualViewport.addEventListener('scroll', setAppHeight, { passive: true });
      }
    })();
  </script>
</body>
</html>
